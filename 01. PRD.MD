# PRD: Платформа аудита сайтов на 1С-Битрикс

**Уровень неопределённости:** 0% (все критические вводные получены)

---

## Продуктовое видение
Создать гибридную (облако + модуль) модульно-расширяемую платформу аудита сайтов на «1С-Битрикс», позволяющую быстро и точно выявлять технические и SEO-проблемы, предоставлять понятные отчёты для разных ролей и конвертировать аудит в доработки.

---

## 1. Discovery-first (гипотезы и зоны риска)
**Гипотезы:**
- Комплексный аудит ↑ конверсию в доработки ≥10%.
- White-label ↑ удержание агентств на 20%.
- Интеграции ↑ полноту отчётов на 30%.

**Риски:**
- Ограничения API.
- Сложность поддержки старых версий Bitrix.
- Юридические требования к обработке данных (152-ФЗ, GDPR).

**Уровень риска по ключевым фичам:**
- Лид-магнит — низкий.
- Модульная архитектура тестов — средний.
- Интеграции с API — высокий.
- White-label — низкий.

---

## 2. Top-2 цели MVP
1. Запустить лид-магнит и модуль Битрикс с базовыми тестами.
2. Обеспечить интеграцию с Lighthouse, GSC, Яндекс Вебмастер.

**Что не будет сделано в MVP:**
- Автоматический планировщик проверок.
- Полноценный API для сторонних сервисов.
- Автопочинка ошибок.

---

## 3. Mini-backlog
**Сегодня:**
- Лид-магнит (публичный тест URL)
- Модуль Битрикс с базовыми тестами

**Эта неделя:**
- Интеграции с внешними API
- White-label (минимальная версия)

**Бэклог:**
- Планировщик и графики
- Расширенные API
- Автопочинка ошибок

---

## 4. Целевая аудитория и JTBD

| Персона         | JTBD |
|-----------------|------|
| Веб-студия      | «Когда клиент говорит “сайт не работает”, хочу быстро найти причину и дать обоснованный отчёт» |
| SEO-оптимизатор | «Когда позиции падают, хочу понять, какие техошибки мешают продвижению» |
| Владелец сайта  | «Когда сомневаюсь в работоспособности сайта, хочу простой отчёт с рекомендациями» |
| Партнёрское агентство/интегратор | «Хочу white-label и API для интеграции аудита в свои процессы» |

---

## 5. Цели и метрики
- Снижение критических ошибок после исправлений ≥ 50%.
- Средний скоринг сайта после исправлений ≥ 80/100.
- Конверсия с лид-магнита → регистрация ≥ 20%.
- Конверсия с отчёта → обращение к специалистам ≥ 10%.

---

## 6. PR/FAQ
1. **Что такое аудит?** — Комплексная автоматическая проверка сайта по техническим и SEO-критериям.
2. **Работает ли без доступа к админке?** — Да, но с ограниченной глубиной.
3. **Поддерживает ли старые версии Bitrix?** — Да, все версии.
4. **Можно ли добавить свой тест?** — Да, архитектура поддерживает модульное расширение.
5. **Где хранятся доступы?** — Только локально у клиента, в зашифрованном виде.
6. **Есть ли бесплатная версия?** — Да, с ограниченным функционалом.
7. **Как часто можно проверять сайт?** — В MVP — вручную, позже — по расписанию.
8. **Можно ли брендировать отчёт?** — Да, для студий доступен White-label.

---

## 7. User Stories + Acceptance Criteria

**User Story 1**  
Как владелец сайта, хочу ввести URL на публичной странице и получить базовую оценку, чтобы понять, стоит ли делать полный аудит.
```

Scenario: Публичный тест сайта
Given я ввёл URL
When сервис завершил сканирование
Then я вижу общий скоринг
And список ключевых проблем
And кнопку "Сделать полный аудит"

```

**User Story 2**  
Как SEO-оптимизатор, хочу получить подробный отчёт с SEO-ошибками и рекомендациями, чтобы улучшить видимость сайта.
```

Scenario: SEO аудит сайта
Given я запустил аудит из личного кабинета
When сканирование завершено
Then я вижу SEO-оценку
And список ошибок с описанием простыми словами
And рекомендации по исправлению

```

**User Story 3**  
Как разработчик, хочу видеть технические ошибки и их критичность, чтобы быстро исправить баги.
```

Scenario: Технический аудит сайта
Given я запустил аудит из модуля Bitrix
When тесты завершены
Then я вижу ошибки с кодами и логами
And рекомендации по устранению

```

---

## 8. Функциональные требования
- Модульная архитектура тестов.
- Гибридное выполнение тестов (облако/локально).
- История аудитов без ограничений.
- White-label отчёты.
- Ролевая модель доступа.
- Интеграции с внешними API.
- HTML-отчёты с уровнями детализации.
- Комментарии и назначение задач из отчёта.

---

## 9. Нефункциональные требования
- Время полного аудита ≤ 5 мин для сайтов до 100 страниц.
- Доступность сервиса ≥ 99%.
- Шифрование данных AES-256.
- Совместимость с PHP 7.4–8.2.
- Архитектурно — поддержка мультиязычности (RU/EN).

---

## 10. Приоритизация (MoSCoW)
- **Must:** Лид-магнит, модуль Битрикс, базовые тесты, интеграции, история аудитов.
- **Should:** White-label, роли, коллаборация.
- **Could:** Планировщик, API для сторонних сервисов.
- **Won’t:** Автопочинка ошибок.

---

## 11. MVP и релизы
- **MVP (1 месяц):** Лид-магнит, модуль с базовыми тестами, интеграции, White-label (минимум).  
- **R2:** Планировщик, графики изменений, расширенные API.

---

## 12. План валидации
- Тестирование на 10 реальных сайтах.
- Сбор обратной связи по отчётам.
- Анализ конверсий.

---

## 13. Риски и допущения
- Ограничения API сторонних сервисов.
- Изменения в лицензиях Bitrix.
- Требования к сертификации при публикации в Marketplace.

---

## 14. Зависимости
- Google PageSpeed API.
- Яндекс Вебмастер API.
- Bitrix REST API.

---

## 15. DoR / DoD
- **DoR:** описание фичи с AC, макеты, зависимости.  
- **DoD:** тесты пройдены, ошибки P0–P1 устранены, документация обновлена.

---

## 16. Передача (Handoff)
**Business Analyst (BA):**
- Подтвердить сегменты и JTBD.
- Верифицировать гипотезы Discovery-first.
- Уточнить и зафиксировать численные KPI.
- Построить экономику проекта (CAC, LTV, ROI).
- Проработать модель монетизации (тарифы, ограничения, upsell).
- Выполнить анализ рисков.

**UI/UX Designer:**
- Получить подтверждённые сегменты и сценарии.
- Разработать прототипы лид-магнита, личного кабинета и отчётов.
- Обеспечить понятность отчётов для разных ролей.

**Architect:**
- Получить функциональные и нефункциональные требования.
- Спроектировать гибридную архитектуру.
- Определить API между модулем и облаком.
- Обеспечить масштабируемость и простоту добавления тестов.

**Security Specialist:**
- Получить требования к безопасности.
- Проработать хранение доступов (AES-256, локально).
- Проверить модель передачи данных.

**Coder:**
- Получить архитектурное решение.
- Реализовать модуль Битрикс и облачный сервис.
- Подключить внешние API.

**QA:**
- Получить User Stories и AC.
- Разработать тест-кейсы.
- Проверить корректность отчётов.

**DevOps:**
- Получить архитектурные и инфраструктурные требования.
- Настроить окружения для облака и CI/CD.
- Обеспечить мониторинг и бэкапы.

**Doc Writer:**
- Получить финальную версию фич.
- Подготовить user guide для владельцев сайтов, SEO и разработчиков.

**Support:**
- Получить инструкции по продукту.
- Настроить каналы обратной связи.
- Обработать первые обращения и собрать фидбэк.

---

## Дополнения от PO
- **White-label брендинг в MVP:** логотип и контакты партнёра в шапке/футере. Цвета и шрифты — в R2.
- **Частичный отчёт без регистрации:** да, лид-магнит показывает общий скоринг + 2–3 ключевые ошибки с CTA на регистрацию.

---

## Дополнения — ответы на вопросы Архитектора
**Для PO:**
1. В MVP облако будет использоваться как для тяжёлых, так и для базовых тестов, чтобы протестировать интеграции.
2. Договорённостей с Google/Яндекс по квотам пока нет — старт с базовых лимитов.
3. Приоритет white-label в MVP — логотип и контакты. Полный кастом в R2.

**Для BA:**
4. Скорость отклика при высокой нагрузке (>50 одновременных аудитов) учитывается как часть SLA.
5. В MVP аналитика ограничена базовыми метриками (тип аудита, конверсия). Детальная аналитика в backlog.
6. Полный оффлайн-режим не планируется, но часть тестов можно выполнять локально.

**Для Researcher:**
7. Laravel выбран для скорости разработки и доступности команды, Symfony признан избыточным для MVP.
8. Облачная генерация PDF пока не планируется, но рассматривается для масштабирования.
9. Бенчмарков нет — будут проведены тесты на трёх типах сайтов Bitrix.

---

## Дополнения — ответы на вопросы BA
- Подтверждены сегменты: веб-студия, SEO, владелец, партнёрское агентство.
- KPI: снижение критических ошибок ≥50%, средний скоринг ≥80, конверсии 20% и 10%.
- Экономика: расчёты CAC, LTV, ROI перенесены в приложение.
- Гипотезы: комплексный аудит ↑ конверсию, white-label ↑ удержание, интеграции ↑ полноту.
- Приоритизация: Must — лид-магнит, модуль, интеграции, история; Should — white-label; Could — планировщик.
- Риски: API-ограничения, старые версии Bitrix, 152-ФЗ/GDPR.

---

## Правила работы с PRD от других агентов
1. Никогда не изменяй и не переформулируй уже готовые разделы PRD.  
2. Все новые данные из Researcher, BA или других агентов добавляй отдельным блоком "Дополнения" в конце PRD.  
3. В дополнениях:
- Указывать, из какого источника пришла информация.
- Чётко выделять, к какому разделу PRD относится дополнение.
4. Если нужно изменить уже существующий текст PRD:
- Вынести старую и новую версию в чат.
- Запросить у меня подтверждение на замену.
5. Хранить полный PRD в исходном виде, без сокращений и удаления информации.


# Концепт
SaaS-сервис для аудита сайтов на 1C-Битрикс + модуль для Битрикса (агент), который гоняет внутренние проверки и отправляет отчёты в облако. Целевая аудитория: веб-студии и владельцы сайтов на Битриксе. Фокус: SEO/технические ошибки, скорость/веб-виталы, контентные рекомендации, динамика метрик во времени.

# Архитектура (в двух слоях)
1. **Облако (SaaS)**
* **API/Backend:** Node.js (NestJS) или Python (FastAPI).
* **Очереди и воркеры:** BullMQ (Redis) или Celery (Redis/RabbitMQ).
* **Аудиты:** Lighthouse CI/Playwright (headless), интеграция с Google PageSpeed Insights API, интеграция с Яндекс.Вебмастер API (проверить актуальные эндпоинты/ключи при реализации).
* **Хранилище:** PostgreSQL (+ TimescaleDB для метрик по времени), Redis для кэша, S3-совместимое хранилище для отчётов/логов.
* **Фронтенд:** Next.js + Tailwind.
* **Контейнеризация:** Docker + Kubernetes (или ECS) с горизонтальным масштабированием воркеров.
* **Аутентификация:** Email+password, OAuth (Google/Yandex) для удобства.
* **Биллинг:** Stripe/ЮKassa.
* **Вебхуки/интеграции:** Slack/Telegram/Email для алертов.

2. **Модуль для 1C-Битрикс**
* **Стек:** D7, Агент/cron, Админ-страницы настроек, REST-клиент.
* **Что собирает локально:**
* конфиги кеширования (композит, CDN), включены ли управляемый кэш и кеш компонентов;
* robots.txt / sitemap.xml / canonical / hreflang;
* метатеги (title/description), OpenGraph/Twitter, наличие alt у изображений;
* статус-коды, редиректы, 404-страницы;
* заголовки кеширования/сжатия (Cache-Control, ETag, gzip/brotli);
* размер/форматы медиа (WebP/AVIF), критический CSS;
* счетчики веб-виталов (через лёгкий JS-сниппет с отправкой в облако).
* **Отчётность:** шифрованно отправляет JSON-отчёты в облако, умеет запускаться по расписанию и по кнопке.

# Что проверяем (ядро продукта)
* **Скорость и Web Vitals:** LCP, CLS, INP, TTFB, FCP, размер бандла, количество запросов, блокирующие ресурсы.
* **SEO-техника:** индексируемость, sitemap/robots, каноникал, hreflang, OG/Schema.org, 404/5xx, дубли/редирект-петли, пагинация.
* **Контентные сигналы:** длина title/description, h1-структура, частота ключей (без фанатизма), пустые/тонкие страницы.
* **Инфраструктура:** HTTP/2/3, TLS, CDN, кэш/сжатие, изображения.
* **Специфика Битрикс:** композит, кеш компонентов, высоконагруженные блоки, производительность D7 ORM-запросов (базовые эвристики), настройка агентов/кронов.

# Интеграции (внешние источники)
* **Google PageSpeed Insights API** — метрики Lighthouse по десктопу/мобайлу.
* **Яндекс.Вебмастер API** — статус индексирования/ошибок, файлы sitemap, проблемы с роботами и т. п.

> На стадии реализации просто заложить абстракцию `Provider: Google/Yandex`, хранить ключи на проект/пользователя и свериться с актуальными лимитами/эндпоинтами.

# ИИ-начинка (то, что добавляет «вау»)
* **Авто-диагност:** агент, который объединяет результаты всех проверок и формирует приоритезированный чек-лист (P0/P1/P2) по методу *impact × effort*.
* **Объяснения на «человеческом»:** LLM берёт сырые метрики и генерирует понятные пояснения и конкретные шаги *именно для Битрикса*.
* **Автогенерация задач:** выгрузка задач в ClickUp/Jira/YouTrack с готовыми acceptance criteria.
* **Сравнение прогресса:** LLM делает дифф прошлых и текущих отчётов.
* **Релевантные сниппеты:** RAG-слой с документацией Битрикса, Lighthouse и статей по Core Web Vitals.

# Дашборд и UX
* **Главный экран проекта:** сводный скоринг, тренды, список P0-проблем.
* **Деталка по Web Vitals:** графики по дням (TimescaleDB).
* **SEO-карта:** статус sitemap/robots, каноникал, hreflанг-матрица.
* **Отчёты по запускам:** сравнение двух дат, экспорт PDF/CSV.
* **Алерты:** «LCP на мобиле > 4s на /catalog — 12% трафика задеты».

# Модель доступа и монетизация
* **Free:** 1 сайт, 3 запуска/мес, базовый отчёт + PageSpeed.
* **Pro:** 3–5 сайтов, расписание, алерты, интеграции, экспорт, ИИ-объяснения.
* **Agency:** 20–∞ сайтов, командные роли, white-label, вебхуки.

# Безопасность и приватность
* Токены храним шифрованно (KMS/HashiCorp Vault).
* Подпись запросов модуля.
* Минимизация PII.

# Техдетали
**Схема данных:** accounts, users (RBAC), projects, sites, runs, metrics, findings, attachments.
**Очереди задач:** audit:speed, audit:seo, audit:bitrix, sync:search, ai:summary, alerts:dispatch.
**Правила качества:** декларативно (YAML/JSON).

# Модуль для Битрикса
* Админ-раздел: ввод API-ключа SaaS, выбор метрик, расписание.
* Агент/cron: сбор и отправка отчёта.
* JS-сниппет Web Vitals.
* Страница «Локальная диагностика».

# MVP за 6–8 недель
**Недели 1–2:** проектирование БД, интеграция PageSpeed, базовый дашборд.
**Недели 3–4:** краулер, SEO-проверки, модуль Битрикс.
**Недели 5–6:** интеграция Яндекс, ИИ-объяснения, экспорт PDF.
**Недели 7–8:** роли, портфельный дашборд, платежи, UX-полировка.

# Как ИИ помогает
* **Explain-mode**
* **Auto-fix подсказки**
* **План улучшений**
* **Резюме для клиента**

# Риски
* Лимиты API → кеш + backoff.
* Антибот-защита → модуль тестирует приватные зоны.
* Разные конфиги → правила декларативно.
* Стабильность воркеров → контейнерная изоляция.

# Что нужно сейчас
1. Выбрать стек (NestJS или FastAPI).
2. Решить про БД (Postgres vs TimescaleDB).
3. Согласовать тарифы/лимиты.
4. Определить ИИ-фичи в MVP.


## **Ответы PO**

### 1. Монетизация и экономика

1. **ARPU**: подтверждаю для MVP расчётные значения — Pro: **800 ₽/мес**, Agency: **2 500 ₽/мес**. Пересмотрим после первых 3 мес.
2. **Конверсия Free→Pro/Agency**: целевой таргет — **5 %** в первые 3 месяца, далее план +3–5 % ежеквартально.
3. **Retention (WL)**: считаем N-месячный (cohort-based) на горизонте **12 месяцев**.

---

### 2. Функциональный Scope

4. **Explain-mode (ИИ)**: базовая версия в MVP — да, только текстовые пояснения по ключевым P0/P1 проблемам.
5. **Алерты**: в MVP минимальные (по 1–2 предустановленным триггерам), конфигурируемый модуль — в R2.
6. **Интеграции с таск-системами**: в R2, но архитектурно закладываем API-хук уже в MVP.

---

### 3. KPI и аналитика

7. **KPI воронки**: считаем по уникальным пользователям, а не по сессиям.
8. **Веса тестов**: утвердить текущие из BRD, но с возможностью корректировки после консультации с SEO и Dev.
9. **Продуктовая аналитика**: GA4 + Я.Метрика + Amplitude в MVP; Mixpanel — не требуется.

---

### 4. Риски и технические ограничения

10. **API-квоты**: работаем в пределах базовых лимитов, параллельно запросим повышенные у Google/Яндекс.
11. **Оффлайн-режим**: полный не нужен, только частичное локальное выполнение в модуле.
12. **Сертификация Marketplace**: переносим на R2.

---

**Дополнение к PRD — новая фича в MVP**

### **Функция: Конверсионная аналитика для 1С-Битрикс**

**Цель:**
Автоматизировать сбор и анализ данных по конверсиям и рекламным расходам для клиентов на Bitrix, чтобы веб-студии и маркетологи могли видеть полный путь клиента и окупаемость рекламы без ручного сбора данных.

**Возможности:**

1. **Сбор UTM и визитов**

   * Запись UTM-меток и источников при каждом визите.
   * Хранение всей цепочки визитов, а не только last-click.
   * Привязка истории визитов к заказу.

2. **Отдельное хранилище**

   * Данные пишутся в отдельную небитриксовую таблицу (PostgreSQL в облаке).
   * Исключается нагрузка на основную БД Bitrix.

3. **Интеграции с рекламными кабинетами**

   * **Яндекс.Директ API** — загрузка затрат, кликов, показов.
   * **VK Ads API** — загрузка аналогичных данных.
   * В дальнейшем — Google Ads, MyTarget.

4. **Отчётность и аналитика**

   * Сводка по заказам, затратам и доходу.
   * ROI/ROAS по источникам.
   * Визуализация пути клиента (user journey).

**KPI:**

* Снижение потерь конверсий ≥ 90%.
* Экономия времени на отчётность ≥ 50%.

**Примечание:**
Функция внедряется в MVP в минимальном варианте:

* только Яндекс.Директ,
* только базовый путь клиента (до 10 шагов),
* отчёт в виде таблицы + экспорт CSV.

---
